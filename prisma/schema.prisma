// Prisma Schema para CavalcanteReis
// Documentação: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ========== MODELO: PROPOSTA ==========
// Armazena as propostas comerciais geradas pelo sistema
model Proposta {
  id               String   @id @default(uuid())
  municipio        String
  destinatario     String?
  data             String?
  prazo            String?
  services         Json?    // Objeto com serviços selecionados { pasep: true, irrf: false, ... }
  customCabimentos Json?    // Textos personalizados de cabimento
  customEstimates  Json?    // Estimativas personalizadas
  footerOffices    Json?    // Configuração dos escritórios no rodapé
  paymentValue     String?  // Valor do pagamento (ex: "R$ 0,12")
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  expiresAt        DateTime // Data de expiração (padrão: 1 ano)

  @@map("propostas")
}

// ========== MODELO: MINUTA ==========
// Armazena as minutas de contrato geradas pelo sistema
model Minuta {
  id               String   @id @default(uuid())
  municipio        String
  objeto           String?  @db.Text
  valorContrato    String?
  prazoVigencia    String?
  dataAssinatura   String?
  representante    String?
  cargo            String?
  services         Json?    // Serviços selecionados
  customCabimentos Json?    // Textos personalizados
  formData         Json?    // Estado completo do gerador (options, clauseData, percentual)
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  expiresAt        DateTime // Data de expiração (padrão: 1 ano)

  @@map("minutas")
}

// ========== MODELO: ESTUDO DE CONTRATAÇÃO ==========
model EstudoContratacao {
  id        String   @id @default(uuid())
  municipio String
  formData  Json?    // Todos os campos do formulário (processo, local, dia, mes, ano, topicosAtivos)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  expiresAt DateTime // Data de expiração (padrão: 1 ano)

  @@map("estudos_contratacao")
}

// ========== MODELO: TERMO DE REFERÊNCIA ==========
model TermoReferencia {
  id        String   @id @default(uuid())
  municipio String
  formData  Json?    // Todos os campos do formulário
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  expiresAt DateTime // Data de expiração (padrão: 1 ano)

  @@map("termos_referencia")
}

// ========== MODELO: PARECER JURÍDICO ==========
model ParecerJuridico {
  id        String   @id @default(uuid())
  municipio String
  formData  Json?    // Todos os campos do formulário
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  expiresAt DateTime // Data de expiração (padrão: 1 ano)

  @@map("pareceres_juridicos")
}
